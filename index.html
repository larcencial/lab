<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LarcenciaL | Advanced Perfume Architect</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;500;600;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
<style>
    :root {
        --primary: #00f3ff; 
        --secondary: #bc13fe; 
        --bg-dark: #050510;
        --glass: rgba(255, 255, 255, 0.05);
        --glass-border: rgba(255, 255, 255, 0.1);
        --text-main: #e0e6ed;
        --text-muted: #94a3b8;
        --danger: #ff2a2a;
        --success: #00ff9d;
    }

    * { box-sizing: border-box; }
    
    body {
        margin: 0;
        background-color: var(--bg-dark);
        font-family: 'Rajdhani', sans-serif;
        color: var(--text-main);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow-x: hidden;
    }

    /* --- 3D BACKGROUND CANVAS --- */
    #canvas-bg {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        z-index: -1;
        background: radial-gradient(circle at center, #0f0f25 0%, #000000 100%);
    }

    /* --- LANGUAGE SWITCHER --- */
    .lang-switch {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        gap: 10px;
        z-index: 100;
    }
    .lang-btn {
        background: rgba(0,0,0,0.5);
        border: 1px solid var(--glass-border);
        color: var(--text-muted);
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        transition: 0.3s;
    }
    .lang-btn.active {
        border-color: var(--primary);
        color: var(--primary);
        box-shadow: 0 0 10px rgba(0, 243, 255, 0.2);
    }

    /* --- MAIN CONTAINER --- */
    .container {
        width: 95%;
        max-width: 1000px;
        background: var(--glass);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid var(--glass-border);
        border-radius: 24px;
        padding: 40px;
        box-shadow: 0 0 40px rgba(0, 243, 255, 0.1);
        position: relative;
        z-index: 10;
        margin: 20px 0;
        transition: border-color 0.3s, box-shadow 0.3s;
    }
    
    /* Alarm State Style */
    .container.alarm-state {
        border-color: var(--danger);
        box-shadow: 0 0 50px rgba(255, 42, 42, 0.2);
    }

    /* Header */
    .header { text-align: center; margin-bottom: 30px; }
    h1 {
        font-family: 'Orbitron', sans-serif;
        font-size: 3.5rem;
        margin: 0;
        background: linear-gradient(90deg, #fff, var(--primary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: 4px;
        text-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
    }
    .subtitle { color: var(--secondary); letter-spacing: 2px; font-weight: 700; }

    /* Grid & Inputs */
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .input-group label { display: block; color: var(--primary); margin-bottom: 8px; font-weight: 700; font-size: 0.9rem; text-transform: uppercase;}
    .input-wrapper { position: relative; background: rgba(0,0,0,0.3); border-radius: 8px; border-bottom: 2px solid var(--glass-border); }
    input { width: 100%; background: transparent; border: none; padding: 15px; color: #fff; font-family: 'Orbitron', sans-serif; font-size: 1.2rem; outline: none; }
    .unit { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 0.8rem; pointer-events: none; }

    /* Switch */
    .switch-box { display: flex; background: rgba(0,0,0,0.4); border-radius: 8px; padding: 4px; position: relative; height: 54px; border: 1px solid var(--glass-border); cursor: pointer;}
    .switch-option { flex: 1; text-align: center; line-height: 46px; z-index: 2; font-weight: 700; transition: color 0.3s; color: var(--text-muted); }
    .switch-option.active { color: #000; }
    #switch-bg { position: absolute; top: 4px; left: 4px; width: calc(50% - 4px); height: calc(100% - 8px); background: var(--primary); border-radius: 6px; transition: 0.3s; z-index: 1; }

    /* Results */
    .results-area { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px; }
    .result-card { background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 16px; padding: 20px; text-align: center; transition: 0.3s; }
    .result-card:hover { border-color: var(--secondary); box-shadow: 0 0 15px rgba(188, 19, 254, 0.2); }
    .res-value { font-family: 'Orbitron', sans-serif; font-size: 2rem; font-weight: 700; color: #fff; transition: color 0.3s;}
    .res-sub { color: var(--primary); font-size: 0.9rem; margin-top: 5px; }

    /* Warning Box */
    #abv-warning-box {
        display: none;
        margin-top: 20px;
        padding: 15px;
        background: rgba(255, 42, 42, 0.1);
        border: 1px solid var(--danger);
        border-radius: 8px;
        color: var(--danger);
        text-align: center;
        font-weight: bold;
        font-family: 'Rajdhani', sans-serif;
        letter-spacing: 1px;
        animation: pulseWarn 2s infinite;
        white-space: pre-line; /* Satƒ±r ba≈ülarƒ±nƒ± tanƒ±masƒ± i√ßin */
    }
    
    @keyframes pulseWarn {
        0% { box-shadow: 0 0 0 rgba(255, 42, 42, 0); }
        50% { box-shadow: 0 0 20px rgba(255, 42, 42, 0.3); }
        100% { box-shadow: 0 0 0 rgba(255, 42, 42, 0); }
    }
    
    /* Maturation Section */
    .maturation-box {
        margin-top: 20px;
        padding: 15px;
        background: rgba(0, 255, 157, 0.05);
        border: 1px dashed var(--success);
        border-radius: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 1.1rem;
    }
    .date-val { font-family: 'Orbitron', sans-serif; color: var(--success); margin-left: 10px; }

    /* Actions & Saved List */
    .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
    .btn { padding: 15px; background: transparent; border: 1px solid var(--primary); color: var(--primary); font-family: 'Orbitron', sans-serif; font-weight: 700; cursor: pointer; transition: 0.3s; text-transform: uppercase; }
    .btn:hover { background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary); }
    .btn-save { border-color: var(--secondary); color: var(--secondary); }
    .btn-save:hover { background: var(--secondary); color: #fff; box-shadow: 0 0 20px var(--secondary); }
    .saved-list-container { margin-top: 30px; border-top: 1px solid var(--glass-border); padding-top: 20px; }
    .saved-title { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
    #saved-items { display: flex; flex-direction: column; gap: 10px; max-height: 200px; overflow-y: auto; }
    .saved-item { display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.05); padding: 10px 15px; border-radius: 8px; }
    .saved-info { display: flex; gap: 15px; align-items: center; }
    .saved-actions button { background: none; border: none; color: var(--text-muted); cursor: pointer; margin-left: 10px; font-size: 0.9rem; }

    /* --- PRINT STYLES --- */
    @media print {
        body { background: #fff; color: #000; display: block; padding: 0; margin: 0; }
        #canvas-bg, .lang-switch, .btn, .switch-box, .saved-list-container, .input-wrapper { display: none !important; }
        .container { 
            box-shadow: none; border: none; backdrop-filter: none; 
            width: 100%; max-width: 100%; padding: 0; margin: 0;
            color: #000;
        }
        .container.alarm-state { border: none; box-shadow: none; } 
        
        .header h1 { 
            background: none; -webkit-text-fill-color: #000; color: #000; 
            text-shadow: none; font-family: "Times New Roman", serif; font-size: 24pt; 
            margin-bottom: 5px;
        }
        .subtitle { color: #000; font-family: "Times New Roman", serif; font-size: 12pt; margin-bottom: 20px; font-weight: normal; }
        
        /* Custom Print Layout */
        .grid, .results-area, .maturation-box { display: block; width: 100%; margin: 10px 0; border: none; background: none; }
        .input-group { border-bottom: 1px dotted #000; padding: 5px 0; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .input-group label { color: #000; font-family: "Times New Roman", serif; font-size: 15pt; font-weight: bold; display: inline-block; }
        .input-group::after { content: attr(data-print-value); font-family: "Times New Roman", serif; font-size: 15pt; }

        .result-card { 
            border: 1px solid #000; border-radius: 0; margin-bottom: 10px; 
            padding: 10px; text-align: left; box-shadow: none; background: none;
        }
        .res-label { color: #000; font-family: "Times New Roman", serif; font-size: 12pt; font-weight: bold; }
        .res-value { color: #000; font-family: "Times New Roman", serif; font-size: 15pt; font-weight: normal; text-shadow: none; }
        
        /* Warning in Print */
        #abv-warning-box {
            border: 2px solid red !important;
            color: red !important;
            font-family: "Times New Roman", serif;
            font-weight: bold;
            background: none !important;
            animation: none !important;
            display: block !important;
        }

        .maturation-box { border: 1px solid #000; color: #000; border-radius: 0; font-family: "Times New Roman", serif; font-size: 15pt; }
        .date-val { color: #000; font-weight: bold; font-family: "Times New Roman", serif; }
        .input-wrapper, .switch-container { display: none; }
    }
</style>
</head>
<body>

<canvas id="canvas-bg"></canvas>

<div class="lang-switch">
    <div class="lang-btn active" onclick="setLang('tr')">TR</div>
    <div class="lang-btn" onclick="setLang('en')">EN</div>
</div>

<div class="container" id="main-panel">
    <div class="header">
        <h1>LarcenciaL</h1>
        <div class="subtitle" id="txt_subtitle">Y√úKSEK PARF√úM Mƒ∞MARƒ∞Sƒ∞</div>
    </div>

    <div class="grid">
        <div class="input-group" id="grp_vt">
            <label id="lbl_vt">Hedef Hacim</label>
            <div class="input-wrapper">
                <input type="number" id="inp_vt" value="100">
                <span class="unit">mL</span>
            </div>
        </div>

        <div class="switch-container">
            <div class="input-group">
                <label id="lbl_mode">Hesaplama Modu</label>
            </div>
            <div class="switch-box" onclick="toggleSwitch()">
                <div id="switch-bg"></div>
                <div class="switch-option active" id="opt-pct" data-val="pct">Y√úZDE (%)</div>
                <div class="switch-option" id="opt-gram" data-val="gram">GRAM (g)</div>
            </div>
        </div>

        <div class="input-group" id="grp_target">
            <label id="lbl_target">Esans Oranƒ±</label>
            <div class="input-wrapper">
                <input type="number" id="inp_target" value="22">
                <span class="unit" id="unit_target">%</span>
            </div>
        </div>

        <div class="input-group" id="grp_rho">
            <label id="lbl_rho">Esans Yoƒüunluƒüu</label>
            <div class="input-wrapper">
                <input type="number" id="inp_rho" value="1.02" step="0.01">
                <span class="unit">g/mL</span>
            </div>
        </div>

        <div class="input-group" id="grp_pur">
            <label id="lbl_pur">Alkol Saflƒ±ƒüƒ±</label>
            <div class="input-wrapper">
                <input type="number" id="inp_pur" value="96">
                <span class="unit">% v/v</span>
            </div>
        </div>

        <div class="input-group" id="grp_water">
            <label id="lbl_water">Saf Su (Distile)</label>
            <div class="input-wrapper">
                <input type="number" id="inp_water" value="0">
                <span class="unit">mL</span>
            </div>
        </div>
    </div>

    <div class="results-area">
        <div class="result-card">
            <div class="res-label" id="lbl_res_esans">Gerekli Esans</div>
            <div class="res-value" id="res_esans_g">0 g</div>
            <div class="res-sub" id="res_esans_ml">0 mL</div>
        </div>
        <div class="result-card">
            <div class="res-label" id="lbl_res_alkol">Gerekli Alkol (%96)</div>
            <div class="res-value" id="res_alkol_g">0 g</div>
            <div class="res-sub" id="res_alkol_ml">0 mL</div>
        </div>
        <div class="result-card" id="card_abv">
            <div class="res-label" id="lbl_res_final">Final Durum</div>
            <div class="res-value" id="res_abv">%0</div>
            <div class="res-sub">ABV (v/v)</div>
        </div>
    </div>
    
    <div id="abv-warning-box">
        ‚ö†Ô∏è UYARI METNƒ∞ BURAYA GELECEK
    </div>

    <div class="maturation-box">
        <span id="lbl_maturation">üß™ Demlenme Tarihi:</span>
        <span class="date-val" id="date_ready">---</span>
    </div>

    <div class="actions">
        <button class="btn btn-save" onclick="saveFormula()" id="btn_save">üíæ FORM√úL√ú KAYDET</button>
        <button class="btn" onclick="window.print()" id="btn_print">üñ®Ô∏è RAPORLA (YAZDIR)</button>
    </div>

    <div class="saved-list-container">
        <div class="saved-title" id="lbl_saved_title">KAYITLI FORM√úLLER</div>
        <div id="saved-items"></div>
    </div>
</div>

<script>
    /* --- CONFIG & STATE --- */
    let lang = 'tr'; 
    let calcMode = 'pct'; 
    const rho96 = 0.831;

    // DICTIONARY
    const i18n = {
        tr: {
            subtitle: "Y√úKSEK PARF√úM Mƒ∞MARƒ∞Sƒ∞",
            vt: "Hedef Hacim",
            mode: "Hesaplama Modu",
            target_pct: "Hedef Esans Oranƒ±",
            target_gram: "Eldeki Esans Miktarƒ±",
            rho: "Esans Yoƒüunluƒüu",
            pur: "Alkol Saflƒ±ƒüƒ±",
            water: "Saf Su (Distile)", // G√úNCELLENDƒ∞
            res_esans: "Gerekli Esans",
            res_alkol: "Gerekli Alkol (%96)",
            res_final: "Final Alkol Oranƒ±",
            maturation: "üß™ Kullanƒ±ma Hazƒ±r:",
            save_btn: "üíæ FORM√úL√ú KAYDET",
            print_btn: "üñ®Ô∏è RAPORLA (YAZDIR)",
            saved_title: "KAYITLI FORM√úLLER",
            opt_pct: "Y√úZDE (%)",
            opt_gram: "GRAM (g)",
            prompt_name: "Form√ºl i√ßin bir isim giriniz:",
            load: "Y√úKLE",
            del: "Sƒ∞L",
            warn_abv: "√ñNERƒ∞LEN ALKOL ORANI %70 ƒ∞LA %80 ARALIƒûINDA OLMALIDIR.\nDAHA A≈ûAƒûISI PERFORMANS KAYBIYLA SONU√áLANIR."
        },
        en: {
            subtitle: "HIGH PERFUME ARCHITECTURE",
            vt: "Target Volume",
            mode: "Calculation Mode",
            target_pct: "Target Essence Ratio",
            target_gram: "Available Essence",
            rho: "Essence Density",
            pur: "Alcohol Purity",
            water: "Distilled Water", // G√úNCELLENDƒ∞
            res_esans: "Required Essence",
            res_alkol: "Required Alcohol (%96)",
            res_final: "Final ABV",
            maturation: "üß™ Ready for Use:",
            save_btn: "üíæ SAVE FORMULA",
            print_btn: "üñ®Ô∏è PRINT REPORT",
            saved_title: "SAVED FORMULAS",
            opt_pct: "PERCENT (%)",
            opt_gram: "GRAM (g)",
            prompt_name: "Enter a name for this formula:",
            load: "LOAD",
            del: "DEL",
            warn_abv: "RECOMMENDED ALCOHOL LEVEL IS BETWEEN 70% AND 80%.\nVALUES OUTSIDE THIS RANGE CAUSE PERFORMANCE LOSS."
        }
    };

    /* --- LANGUAGE HANDLER --- */
    function setLang(l) {
        lang = l;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        const t = i18n[lang];
        document.getElementById('txt_subtitle').innerText = t.subtitle;
        document.getElementById('lbl_vt').innerText = t.vt;
        document.getElementById('lbl_mode').innerText = t.mode;
        document.getElementById('lbl_rho').innerText = t.rho;
        document.getElementById('lbl_pur').innerText = t.pur;
        document.getElementById('lbl_water').innerText = t.water;
        document.getElementById('lbl_res_esans').innerText = t.res_esans;
        document.getElementById('lbl_res_alkol').innerText = t.res_alkol;
        document.getElementById('lbl_res_final').innerText = t.res_final;
        document.getElementById('lbl_maturation').innerText = t.maturation;
        document.getElementById('btn_save').innerText = t.save_btn;
        document.getElementById('btn_print').innerText = t.print_btn;
        document.getElementById('lbl_saved_title').innerText = t.saved_title;
        document.getElementById('opt-pct').innerText = t.opt_pct;
        document.getElementById('opt-gram').innerText = t.opt_gram;
        
        // Uyarƒ± metnini g√ºncelle
        document.getElementById('abv-warning-box').innerText = t.warn_abv;

        updateModeLabel();
        calculate(); 
        renderSavedList();
    }

    function updateModeLabel() {
        const lbl = document.getElementById('lbl_target');
        if (calcMode === 'pct') lbl.innerText = i18n[lang].target_pct;
        else lbl.innerText = i18n[lang].target_gram;
    }

    /* --- CALCULATION LOGIC --- */
    function num(id) { return parseFloat(document.getElementById(id).value) || 0; }
    function fmt(n) { return n.toLocaleString(lang === 'tr' ? 'tr-TR' : 'en-US', {maximumFractionDigits: 2}); }

    function calculate() {
        const Vt = num('inp_vt');
        const val = num('inp_target');
        const rhoe = num('inp_rho');
        const sA = num('inp_pur') / 100;
        const Wml = num('inp_water');

        let me = 0, m96 = 0, Ve = 0, V96 = 0, finalAbv = 0;

        if (calcMode === 'pct') {
            const we = val / 100;
            const denom = (we/rhoe) + ((1-we)/rho96);
            const M = (Vt - Wml) / denom;
            me = we * M;
            m96 = (1-we) * M;
            Ve = me / rhoe;
            V96 = m96 / rho96;
            finalAbv = 100 * (sA * V96) / Vt;
        } else {
            me = val;
            Ve = me / rhoe;
            V96 = Vt - Ve - Wml;
            m96 = V96 * rho96;
            finalAbv = 100 * (sA * V96) / Vt;
        }

        // DOM Updates
        document.getElementById('res_esans_g').innerText = fmt(me) + " g";
        document.getElementById('res_esans_ml').innerText = fmt(Ve) + " mL";
        document.getElementById('res_alkol_g').innerText = fmt(m96) + " g";
        document.getElementById('res_alkol_ml').innerText = fmt(V96) + " mL";
        const abvEl = document.getElementById('res_abv');
        abvEl.innerText = "%" + fmt(finalAbv);

        // VALIDATION (70-80 RULE)
        const warnBox = document.getElementById('abv-warning-box');
        const container = document.getElementById('main-panel');
        
        if (finalAbv >= 70 && finalAbv <= 80) {
            warnBox.style.display = 'none';
            abvEl.style.color = '#fff'; 
            container.classList.remove('alarm-state');
        } else {
            warnBox.style.display = 'block';
            warnBox.innerText = i18n[lang].warn_abv;
            abvEl.style.color = 'var(--danger)';
            container.classList.add('alarm-state');
        }

        // Maturation Date
        const today = new Date();
        today.setDate(today.getDate() + 30);
        document.getElementById('date_ready').innerText = today.toLocaleDateString(lang === 'tr' ? 'tr-TR' : 'en-US');

        // Print Attributes
        document.getElementById('grp_vt').setAttribute('data-print-value', Vt + " mL");
        document.getElementById('grp_target').setAttribute('data-print-value', val + (calcMode==='pct'?'%':' g'));
        document.getElementById('grp_rho').setAttribute('data-print-value', rhoe + " g/mL");
        document.getElementById('grp_pur').setAttribute('data-print-value', (sA*100) + "%");
        document.getElementById('grp_water').setAttribute('data-print-value', Wml + " mL");
    }

    function toggleSwitch() {
        const bg = document.getElementById('switch-bg');
        const optPct = document.getElementById('opt-pct');
        const optGram = document.getElementById('opt-gram');
        const unit = document.getElementById('unit_target');

        if (calcMode === 'pct') {
            calcMode = 'gram';
            bg.style.transform = 'translateX(100%)';
            optPct.classList.remove('active');
            optGram.classList.add('active');
            unit.innerText = "g";
        } else {
            calcMode = 'pct';
            bg.style.transform = 'translateX(0)';
            optGram.classList.remove('active');
            optPct.classList.add('active');
            unit.innerText = "%";
        }
        updateModeLabel();
        calculate();
    }

    /* --- DATABASE & PARTICLES --- */
    function saveFormula() {
        const name = prompt(i18n[lang].prompt_name);
        if(!name) return;
        const data = {
            id: Date.now(),
            name: name,
            vt: document.getElementById('inp_vt').value,
            mode: calcMode,
            target: document.getElementById('inp_target').value,
            rho: document.getElementById('inp_rho').value,
            pur: document.getElementById('inp_pur').value,
            water: document.getElementById('inp_water').value,
            date: new Date().toLocaleDateString()
        };
        let list = JSON.parse(localStorage.getItem('larcencial_formulas')) || [];
        list.push(data);
        localStorage.setItem('larcencial_formulas', JSON.stringify(list));
        renderSavedList();
    }

    function renderSavedList() {
        const list = JSON.parse(localStorage.getItem('larcencial_formulas')) || [];
        const container = document.getElementById('saved-items');
        container.innerHTML = '';
        list.slice().reverse().forEach(item => {
            const div = document.createElement('div');
            div.className = 'saved-item';
            div.innerHTML = `
                <div class="saved-info">
                    <span style="color:var(--primary); font-weight:bold;">${item.name}</span>
                    <span style="font-size:0.8rem; color:var(--text-muted);">(${item.date})</span>
                </div>
                <div class="saved-actions">
                    <button onclick="loadFormula(${item.id})">[${i18n[lang].load}]</button>
                    <button onclick="deleteFormula(${item.id})" style="color:var(--danger);">[${i18n[lang].del}]</button>
                </div>
            `;
            container.appendChild(div);
        });
    }

    function loadFormula(id) {
        const list = JSON.parse(localStorage.getItem('larcencial_formulas')) || [];
        const item = list.find(x => x.id === id);
        if(item) {
            document.getElementById('inp_vt').value = item.vt;
            document.getElementById('inp_target').value = item.target;
            document.getElementById('inp_rho').value = item.rho;
            document.getElementById('inp_pur').value = item.pur;
            document.getElementById('inp_water').value = item.water;
            if(item.mode !== calcMode) toggleSwitch();
            calculate();
        }
    }

    function deleteFormula(id) {
        let list = JSON.parse(localStorage.getItem('larcencial_formulas')) || [];
        list = list.filter(x => x.id !== id);
        localStorage.setItem('larcencial_formulas', JSON.stringify(list));
        renderSavedList();
    }

    // Particles
    const canvas = document.getElementById('canvas-bg');
    const ctx = canvas.getContext('2d');
    let particlesArray;
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    class Particle {
        constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.directionX = (Math.random() * 0.4) - 0.2;
            this.directionY = (Math.random() * 0.4) - 0.2;
            this.size = Math.random() * 2;
            this.color = '#00f3ff';
        }
        draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); ctx.fillStyle = this.color; ctx.fill(); }
        update() {
            if (this.x > canvas.width || this.x < 0) this.directionX = -this.directionX;
            if (this.y > canvas.height || this.y < 0) this.directionY = -this.directionY;
            this.x += this.directionX; this.y += this.directionY; this.draw();
        }
    }
    function initParticles() {
        particlesArray = [];
        let numberOfParticles = (canvas.height * canvas.width) / 9000;
        for (let i = 0; i < numberOfParticles; i++) particlesArray.push(new Particle());
    }
    function animateParticles() {
        requestAnimationFrame(animateParticles);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < particlesArray.length; i++) particlesArray[i].update();
        connect();
    }
    function connect() {
        for (let a = 0; a < particlesArray.length; a++) {
            for (let b = a; b < particlesArray.length; b++) {
                let distance = ((particlesArray[a].x - particlesArray[b].x) ** 2) + ((particlesArray[a].y - particlesArray[b].y) ** 2);
                if (distance < (canvas.width/7) * (canvas.height/7)) {
                    ctx.strokeStyle = 'rgba(0, 243, 255,' + (1 - (distance / 20000)) + ')';
                    ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(particlesArray[a].x, particlesArray[a].y); ctx.lineTo(particlesArray[b].x, particlesArray[b].y); ctx.stroke();
                }
            }
        }
    }
    window.addEventListener('resize', function() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; initParticles(); });

    initParticles(); animateParticles();
    document.querySelectorAll('input').forEach(i => i.addEventListener('input', calculate));
    calculate();
    renderSavedList();

</script>
</body>
</html>
